import{r as f,j as i}from"./request-D8QPoEHx.js";import{l as g,d as b,m as o,b as l,o as r}from"./vendor-CNxIU86K.js";import{n,a as h}from"./index-ES7BnZvW.js";const y=e=>f({method:"post",url:"/user/login",data:e,noToken:!0}),u="Blade-Auth",c="USER_INFO";function I(){const e=localStorage.getItem(u),t=localStorage.getItem(c),s=t?JSON.parse(t):null;return{token:e,userInfo:s}}const k=g("auth",{state:()=>({...I()}),getters:{isLogin:e=>!!e.token},actions:{setAuth(e,t){this.token=e,this.userInfo=t,localStorage.setItem(u,e),localStorage.setItem(c,JSON.stringify(t))},clear(){this.token=null,this.userInfo=null,localStorage.removeItem(u),localStorage.removeItem(c)}}}),S=b({name:"HomeLogin",setup(){const e=o(""),t=o(""),s=o(!1),d=k(),m=async()=>{if(!e.value||!t.value){n("\u8BF7\u8F93\u5165\u7528\u6237\u540D\u4E0E\u5BC6\u7801");return}try{s.value=!0;const a=await y({userName:e.value,password:t.value});if(a.success){const{token:p,userInfo:v}=a.data;d.setAuth(p,v),h("\u767B\u5F55\u6210\u529F"),i()}else n(a.msg||"\u767B\u5F55\u5931\u8D25")}catch(a){n((a==null?void 0:a.message)||"\u8BF7\u6C42\u5931\u8D25")}finally{s.value=!1}};return()=>l("div",{class:"flex flex-col items-center w-full"},[l("div",{class:"w-80 pt-10"},[l("div",{class:"mb-4"},[l("label",{class:"block mb-2"},[r("\u7528\u6237\u540D")]),l("input",{class:"w-full border rounded px-3 py-2",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",value:e.value,onInput:a=>e.value=a.target.value},null)]),l("div",{class:"mb-6"},[l("label",{class:"block mb-2"},[r("\u5BC6\u7801")]),l("input",{class:"w-full border rounded px-3 py-2",type:"password",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",value:t.value,onInput:a=>t.value=a.target.value},null)]),l("div",{class:"flex justify-between items-center"},[l("button",{class:"px-4 py-2 border rounded hover:bg-gray-50 disabled:opacity-50",onClick:m,disabled:s.value},[s.value?"\u767B\u5F55\u4E2D...":"\u767B\u5F55"]),l("button",{class:"px-4 py-2 text-primary-600 hover:underline",onClick:()=>{i()}},[r("\u5148\u770B\u770B\u5DE5\u5177")])])])])}});export{S as default};
